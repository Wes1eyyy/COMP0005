[数据结构：用2-3树来理解红黑树_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Q24y1y7pP/?spm_id_from=333.337.search-card.all.click&vd_source=1970b1cb79523da04f01ebdee092447d)
### 2-3 Trees

2-3树是一种平衡的搜索树，其中每个节点可以有两个或三个子节点和一个或两个键。
  
**核心特性**：
- **节点组成**：一个2-节点包含一个键和两个子节点（或没有子节点），一个3-节点包含两个键和三个子节点（或没有子节点）。
- **3-节点逻辑**:3-节点包含两个键A|B,其中左边的字节点比AB小，中间的字节点比A大比B小，右边的子节点比AB大
- **平衡性**：所有叶子节点都在同一层，确保了从根节点到任意叶子节点的路径长度相等，从而保持了树的平衡。
- **数据分布**：每个节点中的键会将子树的数据分区为两个或三个区间，每个子树包含的键都位于相应区间内。

**操作**：
- **插入**：在2-3树中插入一个新键时，键首先被放置在正确的叶子位置。如果这导致了一个节点变成4-节点（不允许的情况），则该节点将被分裂，中间的键向上移动到父节点中。
- **删除**：从2-3树中删除键涉及到从叶子节点移除键，如果这导致节点下溢，则可能需要键的借用或节点的合并来保持树的平衡。

### Left-Leaning Red-Black Trees (LLRB)

Left-Leaning Red-Black Trees（LLRB）是红黑树的一种变体，由Robert Sedgewick发明。LLRB 的设计使它更易于实现和理解，同时保持红黑树的核心特性，如平衡性和提供对数时间复杂度的操作。

**核心特性和规则**：
- **红链接和黑链接**：LLRB使用标准的二叉树结构，其中节点之间的链接要么是红色，要么是黑色。红链接表示两个节点具有逻辑上的2-3树连接，即红链接“倾斜”或“倾向”于左边。
- **节点颜色**：每个节点要么是红色，要么是黑色。
- **左倾性质**：所有红色链接必须为左链接。这意味着没有任何节点应有一个右子节点为红色的红色链接。
- **完美黑色平衡**：从任一节点到其所有叶子节点的路径中，黑色链接的数量必须相同。

**左倾红黑树LLRB操作**：
- 插入(Insertion/Put)：
	- 左旋转(Left Rotate):![[Pasted image 20240513061728.png]]
		- 有母节点A，其右红指针指向其子节点B，进行左旋转
		- 将红指针由B指向A，即将AB指针方向互换
		- 将A指针的右指针指向B的左指针
		- 删除B原有的左指针

	- 右旋转(Right Rotate):![[Pasted image 20240513062342.png]]
		- 有母节点A，其左红指针指向其子节点B，进行右旋转
		- 将红指针由B指向A，即将AB指针方向互换
		- 将A指针的左指针指向B指针的右指针
		- 删除B原有的右指针

	- 红吸(Flip Color)：![[Pasted image 20240513063641.png]]
		- 有母节点A，其拥有两个红色指针，上方指针为黑色
		- 将红色指针变为黑色
		- 将黑色指针变为红色

	- 调整规则(按优先级排序)：
		- 1.根节点上方只能为黑色指针
		- 2.节点不能有两根红色指针
		- 3.红色指针不能指向右边
		- 4.红色指针指向的子节点不能有红色指针

	- 调整逻辑：![[Pasted image 20240513063943.png]]
		- 通过正常BST查找法，将新节点A找到其空位完成插入，从其母节点建立**红色指针**指向节点A

		- 循环检测调整规则是否被违背：
			- 1.如果**根节点**上方为红色指针：
				- 将红色指针变为黑色
			- 2.如果节点X存在两根红色指针：
				- 进行红吸(Flip Color)![[Pasted image 20240513065012.png]]
			- 3.如果节点X存在右侧红指针：
				- 进行左旋转(Left Rotate)![[Pasted image 20240513065141.png]]
			- 4.如果节点X的红色指针指向的左节点存在红色指针：
				- 进行右旋转(Right Rotate)![[Pasted image 20240513065032.png]]

	- 注意事项：
		- 根节点的上方不能是红色指针
		- 指向新插入的节点的指针只能是红色指针
		- 调整规则具有优先级
		- 节点上方为红色指针时不能进行红吸操作，跳过该判断

### 差异和联系

LLRB可以被视为2-3树的一种二叉树表示。实际上，LLRB的设计是为了模拟2-3树的行为：
- **LLRB与2-3树**：LLRB的红链接可以视为将两个2-节点连接成一个3-节点，而黑链接则维持2-3树节点之间的正常分界。
- **操作对应**：在LLRB中进行的旋转和重新着色操作对应于在2-3树中进行节点的分裂、合并和键的重新分配。

这两种结构都致力于保持树的高度尽可能低，从而确保搜索、插入和删除操作的效率。选择使用哪一种结构取决于具体实现的复杂性、操作的频率和程序员对数据结构的熟悉程度。